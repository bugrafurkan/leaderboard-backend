# RabbitMQ 10M+ eş zamanlı kullanıcı için yapılandırma

# Disk ve bellek limitleri
vm_memory_high_watermark.relative = 0.7
disk_free_limit.relative = 2.0

# İşlem limitleri
channel_max = 10000
max_message_size = 134217728 # 128MB

# Kuyruk özellikleri
# Her kuyruk için boyut sınırı ve TTL
queue_max_length = 100000 # Kuyruk başına maks mesaj
queue_max_bytes = 1073741824 # 1GB
queue_max_priority = 10
queue_overflow_strategy = reject-publish

# Ağ yapılandırması
tcp_listen_options.backlog = 4096
tcp_listen_options.nodelay = true
tcp_listen_options.exit_on_close = false

# Message durability
message_store_credit_disc_bound.hard_limit = 1000000
message_store_credit_disc_bound.soft_limit = 500000

# Heartbeat 
heartbeat = 60

# Persistance ve durum
mnesia_table_loading_retry_limit = 10
mnesia_table_loading_retry_timeout = 30000

# Performans
mirroring_sync_batch_size = 4096
queue_index_embed_msgs_below = 4096

# Management plugin yapılandırması
management.rates_mode = none
management.sample_retention_policies.global.minute  = 5
management.sample_retention_policies.global.hour    = 60
management.sample_retention_policies.global.day     = 1200
management.sample_retention_policies.basic.minute    = 5
management.sample_retention_policies.basic.hour      = 60